{% extends "layout_public.html.twig" %}

{% set company = guest.system_company %}

{% if settings.theme == 'dark' %}
    {% set logo_url =  company.logo_url_dark %}
{% else %}
    {% set logo_url =  company.logo_url %}
{% endif %}

{% block meta_title %}{{ 'Login'|trans }}{% endblock %}

{% block body_class %}page-login{% endblock %}
{% block body %}
    <div class="page page-center">
      <div class="container container-tight py-4">
        <div class="text-center mb-4">
        {% if settings.login_page_show_logo %}
            <div class="text-center mb-4">
                <a href="{{ settings.login_page_logo_url|default('/') }}" target="_blank" class="navbar-brand navbar-brand-autodark">
                    <img class="navbar-brand-image" height="50px" src="{{ logo_url }}" alt="{{ company.name }}"/>
                </a>
            </div>
        {% endif %}
        </div>
        <div class="card card-md">
          <div class="card-body">
            <h2 class="h2 text-center mb-4">{{ 'Login to your account'|trans }}</h2>
            <form class="api-form auth" action="{{ 'api/guest/client/login'|link }}" method="post" data-api-redirect="{{ redirect_uri|default('/')|link }}">
              <div class="mb-3">
                <label class="form-label">{{ 'Email'|trans }}</label>
                <input type="email" class="form-control" placeholder="{{ 'Enter your email address'|trans }}" name="email" value="{{ request.email }}" required="required" autofocus autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false"/>
              </div>
              <div class="mb-2">
                <label class="form-label">
                  {{ 'Password'|trans }}
                  {% if settings.show_password_reset_link %}
                  <span class="form-label-description">
                    <a href="{{ 'password-reset'|link }}">{{ 'Forgot password?'|trans }}</a>
                  </span>
                  {% endif %}
                </label>
                <div class="input-group input-group-flat">
                  <input type="password" id="password-input" class="form-control" placeholder="{{ 'Enter your password'|trans }}" name="password" required="required" value="{{ request.password }}" autocomplete="off" />
                  <span class="input-group-text">
                    <a href="#" id="toggle-password" class="link-secondary" title="Show password" data-show="{{ 'Show password'|trans }}" data-hide="{{ 'Hide password'|trans }}">
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        class="icon icon-1"
                      >
                        <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
                        <path d="M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6" /></svg
                    ></a>
                  </span>
                </div>
              </div>
              <div class="form-footer">
                <button type="submit" class="btn btn-primary w-100">{{ 'Login'|trans }}</button>
              </div>
            </form>
          </div>
        </div>
        {% if settings.show_signup_link %}
        <div class="text-center text-secondary mt-3">Don't have account yet? <a href="{{ 'signup'|link }}" tabindex="-1">{{ 'Create account'|trans }}</a></div>
        {% endif %}
      </div>
    </div>
<script>
document.getElementById('toggle-password')?.addEventListener('click', function (e) {
    e.preventDefault();

    const input = document.getElementById('password-input');
    const icon = this.querySelector('svg');

    if (!input) return;

    if (input.type === 'password') {
        input.type = 'text';

        this.title = this.dataset.hide;

        // Eye-off icon
        icon.innerHTML = `
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10.585 10.587a2 2 0 0 0 2.829 2.828" /><path d="M16.681 16.673a8.717 8.717 0 0 1 -4.681 1.327c-3.6 0 -6.6 -2 -9 -6c1.272 -2.12 2.712 -3.678 4.32 -4.674m2.86 -1.146a9.055 9.055 0 0 1 1.82 -.18c3.6 0 6.6 2 9 6c-.666 1.11 -1.379 2.067 -2.138 2.87" /><path d="M3 3l18 18" />
        `;
    } else {
        input.type = 'password';

        this.title = this.dataset.show;

        // Eye icon
        icon.innerHTML = `
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" /><path d="M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6" />
        `;
    }
});
</script>
{% endblock %}